{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "height": 400,
  "width": 800,
  "background": "#F0F3FA",
  "data": {
    "url": "data/flights_area.csv"
  },
  "params": [
    {
      "name": "Airline_select",
      "bind": {
        "input": "select",
        "options": [
          null, "AS", "AA", "MQ", "EV", "DL", "F9", "OO",
          "WN", "NK", "US", "UA"
        ],
        "labels": [
          "All",
          "Alaska Airlines Inc.",
          "American Airlines Inc.",
          "American Eagle Airlines Inc.",
          "Atlantic Southeast Airlines",
          "Delta Air Lines Inc.",
          "Frontier Airlines Inc.",
          "Skywest Airlines Inc.",
          "Southwest Airlines Co.",
          "Spirit Air Lines",
          "US Airways Inc.",
          "United Air Lines Inc."
        ],
        "name": "Select Airline: "
      }
    }
  ],
  "transform": [
    {"filter": "Airline_select == null || datum.AIRLINE == Airline_select"},
    {
      "calculate": "if(datum.DELAY_REASON === 'AIRLINE_DELAY', 0, if(datum.DELAY_REASON === 'LATE_AIRCRAFT_DELAY', 1, if(datum.DELAY_REASON === 'AIR_SYSTEM_DELAY', 2, if(datum.DELAY_REASON === 'WEATHER_DELAY', 3, 4))))",
      "as": "delay_order"
    }
  ],
  "mark": "area",
  "encoding": {
    "x": {
      "timeUnit": "month",
      "field": "DATE",
      "type": "ordinal"
    },
    "y": {
      "field": "DELAY",
      "type": "quantitative",
      "aggregate": "average",
      "stack": "normalize"
    },
    "color": {
      "field": "DELAY_REASON",
      "type": "nominal",
      "scale": {
        "range": [
          "#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#E6AB02"
        ]
      }
    },
    "order": {
      "field": "delay_order"
    },
    "tooltip": [
      {"field": "DELAY_REASON", "type": "nominal"},
      {"field": "DELAY", "type": "quantitative", "aggregate": "average"}
    ]
  }
}
